<?php

use PHPUnit\Framework\TestCase;

use \tripal_curator\includes\CV;

final class CV_test extends TestCase {

  //Fake CVterm for testing
  public $CV;

  public function setUp() {

    $CV = new CV;

//We use this cv for testing because it's included in the chado install, linked to properties.
    $cv_record = tripal_get_cv(['name' => 'cvterm_property_type']);
    $CV->set_id($cv_record->cv_id);
    $this->CV = $CV;

  }

  public function test_CV_inits_and_gets_terms() {
    $CV = $this->CV;
    $terms = $CV->get_terms();
    $this->assertNotNull($terms);

    $this->assertNotEmpty($terms);

    foreach ($terms as $term) {

      $this->assertArrayHasKey("type", $term);
      $this->assertArrayHasKey("term_name", $term);
      $this->assertArrayHasKey("value", $term);
    }
  }
  public function test_CV_returns_prop_tables_on_init() {
    $CV = $this->CV;
    $tables =$CV->get_prop_tables();

    $this->assertNotEmpty($tables);

  }

  public function test_CV_returns_specific_terms() {

    $CV = $this->CV;

    $tables =$CV->get_prop_tables();

    $terms = $CV->get_terms_specific([$tables[0]]);

    $this->assertNotNull($terms);
    $this->assertNotEmpty($terms);

  }

}