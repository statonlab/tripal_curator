<?php

use PHPUnit\Framework\TestCase;

use \tripal_curator\Chado_property;

//some reading for organizing and annotating tests
//https://stackoverflow.com/questions/8313283/phpunit-best-practices-to-organize-tests
//https://jtreminio.com/2013/03/unit-testing-tutorial-introduction-to-phpunit/

final class Chado_property_test extends TestCase {


  public $cvterm;
  public $property;

  public function __construct() {
    parent::__construct();


    $cvterm = tripal_insert_cvterm(
      [
        'name' => 'Curator Test',
        'definition' => 'A test CVterm.  Should be deleted in test.',
        'cv_name' => 'tripal',
        'is_relationship' => 0,
        'db_name' => 'tripal',
      ]
    );

    $this->cvterm = $cvterm;

  }

  public function testTrueIsTrue() {
    $foo = TRUE;
    $this->assertTrue($foo);

  }

  public function test_initialize_property() {
    $cvterm = $this->cvterm;

    $property = new Chado_property();
    $this->property= $property;

    $this->assertInstanceOf(Chado_property::class, $property);


  }

 public function test_set_cvtermprop_search_finds_properties() {

   $property = new Chado_property();

   $query = [  'name' => 'comment',
     'cv_id' => array('name' => 'cvterm_property_type')];

   $cvprop_term= tripal_get_cvterm($query);

    $property->set_cvtermprop_search($cvprop_term->cvterm_id);

    $this->assertNotEmpty($property->get_props());

}



//  public function test_property_returns_usage() {
//    $cvterm = $this->cvterm;
//
//    $usage = $this->property->get_usage();
//
//    $this->assertNotNull($usage);
//  }

  public function __destruct() {
    $cvterm = $this->cvterm;
    $values = ['cvterm_id' => $cvterm->cvterm_id];
    chado_delete_record('cvterm', $values);

  }


}
